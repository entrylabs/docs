---
layout: page
title: 인공지능 블록 > 분류 모델 - 음성
date: 2020-11-10 16:18:00
type: userGuide
category: "블록"
order: 33
---

![ai-block-learning-voice](images/window/ai-block-learning-voice.png)

학습 데이터로 입력한 음성을 클래스로 직접 분류하고 학습시키면 새롭게 입력되는 음성을 분류할 수 있는 모델을 만들 수 있습니다. 음성의 파형이 얼마나 유사한지를 기준으로 분류하는 모델이에요.

모델이 학습할 음성은 직접 녹음하거나 wav, mp3 파일로 업로드할 수 있어요. 직접 녹음할 때는 1~3초까지 녹음 길이를 설정할 수 있고, 녹음된 음성의 앞부분과 뒷부분을 잘라낼 수 있는 트리밍 기능을 사용할 수 있답니다.
+ 음성 모델은 사용자의 PC 환경에 따라 로딩 시간이 오래 걸릴 수 있습니다.
+ 음성 모델의 '녹음' 모드는 마이크 사용이 가능한 브라우저에서만 사용할 수 있습니다. 인터넷 익스플로러에서는 마이크 사용이 불가능해 해당 모드를 사용할 수 없습니다.

음성 모델을 선택하면 아래와 같이 음성 모델 학습하기 창이 나타납니다.

![voice-model-window](images/window/voice-model-window.png)

먼저 모델의 이름부터 지어볼까요? 이름 상자를 클릭해서 모델의 이름을 정합니다.

#### ① 클래스 만들기

모델 학습의 첫 단계는 데이터 입력 영역을 **클래스**로 채우는 것이에요. 클래스는 학습할 데이터의 묶음이고, 데이터를 분류하는 기준입니다.

'클래스 추가하기' 버튼을 클릭하면 클래스를 필요한 만큼 추가할 수 있어요.

![voice-model-class](images/window/voice-model-class.png)

각 클래스를 선택하면 자세한 정보와 함께 음성을 입력할 수 있어요. 이름 상자를 클릭하면 클래스의 이름을 정할 수 있습니다. 학습 모델이 알려주는 결과 값으로 클래스 이름을 사용하니까 클래스 이름을 알아보기 쉽게 정해주는 것이 중요해요.

왼쪽의 목록 상자를 클릭하면 음성을 어떻게 입력할 것인지 선택할 수 있어요.
+ **업로드** : 음성 파일을 올립니다. 파일은 10MB 이하여야 하고, wav, mp3 형식(확장자)를 지원해요.
+ **녹음** : 기기와 연결한 마이크로 음성을 녹음합니다. 가운데 상자에서 녹음하는 음성의 파장을 볼 수 있고, '입력하기' 버튼을 눌러 사진을 촬영할 수 있어요.
1~3 초까지 녹음할 수 있고, 양쪽의 빨간 선을 드래그하면 음성의 앞/뒤를 잘라내는 트리밍 기능을 사용할 수 있어요.

<img src="images/window/voice-model-wave.jpeg" alt="voice-model-wave" style="zoom: 33%;" />

각 클래스에 대해서 충분히 학습을 할 수 있도록 최소 5 개 이상의 음성을 입력해야 합니다. 입력한 각 음성은 마우스 포인터를 대거나 터치하면 나타나는 X 버튼을 눌러서 삭제할 수 있어요.

#### ② 학습 조건 설정하기

<img src="images/window/image-model-leaning.png" alt="image-model-leaning" style="zoom:50%;" />

이렇게 2 개 이상의 클래스를 만들고 나면, 학습 영역의 '모델 학습하기' 버튼을 클릭할 수 있습니다. 이 버튼을 바로 눌러 학습을 완료할 수도 있지만, '모델을 학습시킬 수 있습니다' 글씨를 클릭해서 다양한 **학습 조건**을 설정할 수 있어요.

<img src="images/window/image-model-attribute.png" alt="image-model-attribute" style="zoom:50%;" />

+ **세대(Epoch)** : 입력한 데이터를 모두 몇 번씩 학습할 것인지 정하는 부분입니다. 모든 데이터를 1 번씩 학습하는 것을 1 세대라고 불러요. (1 **에포크**라고도 불러요.)
같은 데이터라고 해도 여러 번 학습하면 학습할 수록 모델은 똑똑해집니다.
+ **배치 크기(Batch Size)** : 몇 개의 데이터를 학습하고 모델에 반영할지 정하는 부분입니다.
모든 데이터를 학습하지 않고도 중간중간 지금까지 학습한 데이터를 모델에 반영하는데요. 그것을 몇 개를 기준으로 할지 정한다고 생각하면 돼요.
다만 배치 크기가 너무 크면 학습한 데이터를 모델에 반영하기 전까지 데이터를 많이 입력해야 하고, 너무 작으면 학습한 데이터를 모델에 바로 반영해 정확성은 높아질 수 있지만, 시간이 오래 걸리고 부정확한 데이터가 있을 경우 편향적인 모델이 만들어질 수 있습니다. 따라서, 적당한 배치 크기를 찾는 것이 중요해요.
+ **학습률(Learning Rate)** : 학습한 내용을 모델에 반영할 때, 학습에서 예상되는 에러를 얼마나 고려할 것인지 정하는 부분입니다. 쉽게 말해서, 얼마나 세밀하게 학습할 것인지를 정하는 비율이에요.
학습률이 낮을수록 더 세밀하게 학습하기 때문에 속도가 느립니다. 학습률은 조금만 변경해도 결과에 큰 영향을 주는 부분이니 조심해서 설정해야 해요.
+ **검증 데이터 비율(Validation Rate)** : 입력한 데이터 중 어느정도 비율을 학습한 모델을 검증하는 데에 사용할지 정하는 부분입니다.
검증 데이터 비율을 0.25로 정했다면 4개의 데이터를 입력했을 때 3개는 학습용으로, 1개는 검증용으로 사용하겠다는 뜻이 돼요.

#### ③ 학습 결과 확인하기

학습 조건을 모두 설정했다면 '모델 학습하기' 버튼을 클릭해서, 결과 영역에서 결과를 확인할 수 있습니다.

![voice-model-result](images/window/voice-model-result.png)

클래스에 음성을 입력하는 것처럼, 음성을 업로드해서 학습 모델이 음성을 제대로 학습했는지 확인할 수 있어요.

각 클래스에 얼마나 가까운지 막대 그래프로 비교해보세요!

![voice-model-chart](images/window/voice-model-chart.png)

이렇게 학습을 완료했다면, 학습 영역에서 '차트' 버튼을 클릭하면 학습의 과정을 그래프로 확인할 수 있어요.

가로축은 세대(Epoch)를 나타냅니다. 세로축에서 **acc**는 훈련 정확도를 의미하고, **val_acc**는 검증 정확도를 나타냅니다. 정확도가 1에 가까울수록 더 정확한 인식 결과를 얻을 수 있어요.

## 1. 학습한 모델로 인식하기

![block-ai-model-01](images/block-ai-model-01.png)

데이터 입력 팝업 창을 열고, 입력한 데이터를 학습한 모델로 인식합니다.

<img src="images/window/voice-model-input.png" alt="voice-model-input" style="zoom:50%;" />

동시에 작품을 일시 정지해요. 오른쪽 아래 버튼을 클릭해서 창을 닫지 않고도 작품을 다시 시작할 수 있습니다.

오른쪽 위의 X 버튼을 클릭하면, 데이터를 입력하지 않고 창을 닫을 수도 있어요.

## 2. 인식 결과

![block-ai-model-03](images/block-ai-model-03.png)

입력한 데이터를 학습한 모델로 분류한 결과를 가져오는 값 블록입니다.

입력한 데이터와 가장 유사한 클래스의 이름을 가져와요. 만일 데이터를 입력하지 않았다면 아무 것도 가져오지 않아요.

## 3. `[클래스]` 의 신뢰도

![block-ai-model-04](images/block-ai-model-04.png)

입력한 데이터가 분류된 클래스에 대한 정확도(또는 신뢰도라고도 할 수 있어요)를 가져오는 값 블록입니다.

만일 데이터를 입력하지 않았다면 0 을 가져와요.

목록 상자(<img src="images/icon/dropdown-ai.png" style="zoom:50%;" />)를 클릭하면 정확도를 가져올 클래스를 선택할 수 있어요.

## 4. <인식 결과가 `[클래스]` 인가?>

![block-ai-model-05](images/block-ai-model-05.png)

입력한 데이터가 선택한 클래스와 가장 닮았다면 참, 아니라면 거짓으로 판단하는 블록입니다.

만일 데이터를 입력하지 않았다면 항상 거짓을 가져와요.

목록 상자(<img src="images/icon/dropdown-ai.png" style="zoom:50%;" />)를 클릭하면 결과를 확인할 클래스를 선택할 수 있어요.